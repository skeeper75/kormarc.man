# SPEC-FRONTEND-001: 인수 조건 및 테스트 시나리오

**SPEC ID**: SPEC-FRONTEND-001
**제목**: KORMARC 웹 인터페이스 프론트엔드 UI 구현
**작성자**: 지니
**버전**: 1.0.0
**상태**: 검토 대기

---

## 1. 인수 기준 (Acceptance Criteria)

### AC-1: ISBN 입력 및 검증 기능

**요구사항**: R-F-001 (실시간 ISBN 체크섬 검증)

**승인 기준**:
- ✓ ISBN 필드에 10자리 또는 13자리 숫자 입력 가능
- ✓ ISBN 입력 후 포커스 상실 시 체크섬 자동 검증
- ✓ 유효한 ISBN: 필드 배경색 녹색, 아이콘 체크마크
- ✓ 무효한 ISBN: 필드 배경색 빨강, "유효하지 않은 ISBN입니다" 오류 메시지
- ✓ 검증 상태 스크린 리더로 전달 (aria-live="polite")

**테스트 데이터**:
- 유효한 ISBN-10: `0306406237`
- 유효한 ISBN-13: `9788954687065`
- 무효한 ISBN: `12345`, `999999999999`

---

### AC-2: 필수 필드 검증

**요구사항**: R-F-002 (필수 필드 입력 검증)

**승인 기준**:
- ✓ 필수 필드: ISBN, 제목, 저자, 출판사, 발행년도
- ✓ 모든 필드가 입력되면 "KORMARC 생성" 버튼 활성화
- ✓ 하나 이상의 필드가 비어있으면 버튼 비활성화 (disabled 속성)
- ✓ 버튼 호버 시 비활성 상태에서 "모든 필수 필드를 입력하세요" 툴팁 표시
- ✓ 선택 필드 (주제, 주제명 등)는 비어있어도 버튼 활성화

**테스트 케이스**:
1. 모든 필드 비어있음 → 버튼 비활성화
2. ISBN만 입력 → 버튼 비활성화
3. 모든 필드 입력 → 버튼 활성화
4. 제목만 삭제 → 버튼 비활성화

---

### AC-3: KORMARC 생성 및 API 호출

**요구사항**: R-F-003, R-F-004 (JSON/XML 결과 표시, 로딩 상태)

**승인 기준**:
- ✓ 버튼 클릭 후 로딩 스피너 즉시 표시
- ✓ "KORMARC 생성" 버튼 비활성화 (중복 클릭 방지)
- ✓ API 응답 수신 후 로딩 스피너 사라짐
- ✓ JSON 형식 결과 탭 표시
- ✓ XML 형식 결과 탭 표시
- ✓ 탭 전환 시 해당 형식 내용 표시
- ✓ 코드 포맷팅 및 가독성 있는 들여쓰기

**성능 기준**:
- API 응답 시간 (P95): < 200ms
- 로딩 UI 응답 시간: < 100ms

---

### AC-4: 오류 처리 및 명확한 메시지

**요구사항**: R-F-005 (명확한 오류 메시지), R-F-010 (내부 오류 노출 금지)

**승인 기준**:
- ✓ API 오류 시 사용자 친화적 메시지 표시
  - "KORMARC 생성에 실패했습니다. 다시 시도해주세요."
  - 스택 트레이스나 DB 정보 절대 표시 금지
- ✓ 네트워크 타임아웃: "네트워크 연결을 확인해주세요."
- ✓ 서버 오류 (500): "일시적인 오류가 발생했습니다. 나중에 다시 시도해주세요."
- ✓ "재시도" 버튼 제공
- ✓ 오류 메시지 5초 후 자동 사라짐

**금지 사항**:
- ✗ 스택 트레이스 노출
- ✗ SQL 쿼리 표시
- ✗ 서버 환경 정보 표시
- ✗ 데이터베이스 오류 메시지 노출

---

### AC-5: 보안 - XSS 방지

**요구사항**: R-F-011 (XSS 방지)

**승인 기준**:
- ✓ 모든 사용자 입력이 Zod 스키마로 검증됨
- ✓ 화면에 표시되는 모든 동적 데이터가 React에 의해 자동 이스케이프됨
- ✓ 특수 문자 입력 시 안전하게 렌더링
  - 입력: `<script>alert('XSS')</script>`
  - 화면 표시: `<script>alert('XSS')</script>` (텍스트로 표시, 실행 안 됨)
- ✓ dangerouslySetInnerHTML 사용 금지
- ✓ eval(), Function() 생성자 사용 금지

**테스트 입력**:
- `<img src=x onerror="alert('XSS')">`
- `" onclick="alert('XSS')"`
- `'; DROP TABLE users; --`

---

### AC-6: 결과 내보내기 기능

**요구사항**: R-F-030 (결과 내보내기)

**승인 기준**:
- ✓ "JSON 다운로드" 버튼 클릭 시 JSON 파일 다운로드
  - 파일명: `KORMARC_2026-01-11_140530.json`
  - Content-Type: `application/json`
- ✓ "XML 다운로드" 버튼 클릭 시 XML 파일 다운로드
  - 파일명: `KORMARC_2026-01-11_140530.xml`
  - Content-Type: `application/xml`
- ✓ "클립보드에 복사" 버튼 클릭 시 활성 탭의 내용 복사
- ✓ 복사 후 "복사되었습니다" 토스트 알림 표시 (2초)
- ✓ 복사 실패 시 오류 메시지 표시

**테스트 케이스**:
1. JSON 탭 선택 후 JSON 다운로드 버튼 클릭 → JSON 파일 다운로드됨
2. XML 탭 선택 후 XML 다운로드 버튼 클릭 → XML 파일 다운로드됨
3. JSON 탭 선택 후 복사 버튼 클릭 → JSON 내용 복사됨
4. 클립보드 접근 거부 시 → 오류 메시지 표시

---

### AC-7: 폼 자동 저장

**요구사항**: R-F-020 (폼 데이터 자동 저장)

**승인 기준**:
- ✓ 사용자가 필드에 입력할 때마다 localStorage에 저장
- ✓ 저장 간격: 1초 (디바운싱)
- ✓ 페이지 새로고침 후 이전 데이터 자동 복원
- ✓ 브라우저 개발자 도구에서 localStorage 확인 가능
- ✓ "초기화" 버튼 클릭 시 저장된 데이터 삭제
- ✓ KORMARC 생성 성공 후 자동 저장 데이터 유지 (사용자가 수정할 경우 대비)

**테스트 케이스**:
1. 폼 작성 중 개발자 도구 F12 → Application → LocalStorage에 데이터 저장됨 확인
2. 페이지 새로고침 (Ctrl+R) → 이전 입력 데이터 복원됨
3. "초기화" 버튼 클릭 → 폼 초기화, localStorage 삭제
4. 브라우저 종료 후 재실행 → 이전 데이터 복원됨 (같은 도메인)

---

### AC-8: 폼 초기화 기능

**요구사항**: R-F-031 (폼 초기화)

**승인 기준**:
- ✓ "초기화" 버튼 클릭 시 모든 입력 필드가 초기값으로 복원
- ✓ ISBN, 제목, 저자, 출판사, 발행년도 모두 비워짐
- ✓ 검증 상태 표시 초기화 (회색)
- ✓ localStorage에 저장된 임시 데이터 삭제
- ✓ 결과 창(JSON/XML) 초기화 (표시 안 됨)
- ✓ KORMARC 생성 버튼 비활성화

**테스트 케이스**:
1. 폼 작성 중 "초기화" 버튼 클릭 → 모든 필드 비워짐
2. 초기화 후 localStorage 확인 → 데이터 삭제됨
3. KORMARC 생성 후 "초기화" 버튼 클릭 → 폼과 결과 모두 초기화

---

### AC-9: 검증 상태 시각화

**요구사항**: R-F-021 (검증 상태 시각화)

**승인 기준**:
- ✓ 5단계 색상 상태 표시:
  - 회색: 미입력 (초기 상태)
  - 노랑: 입력 중 (포커스 상태)
  - 녹색: 검증 완료 (유효)
  - 빨강: 검증 실패 (무효)
  - 회색: 비활성 (전체 폼 제출 중)
- ✓ 각 필드 옆에 검증 아이콘 표시
  - 회색: ○
  - 노랑: ⋯
  - 녹색: ✓
  - 빨강: ✗
- ✓ aria-live="polite"로 스크린 리더 호환성
- ✓ aria-label에 상태 텍스트 포함

**테스트 케이스**:
1. 페이지 로드 → 모든 필드 회색 (○)
2. ISBN 필드 클릭 → 노랑 (⋯)으로 변경
3. 유효한 ISBN 입력 → 녹색 (✓)으로 변경
4. 무효한 ISBN 입력 → 빨강 (✗)으로 변경
5. 스크린 리더 실행 → 상태 텍스트 읽혀짐

---

## 2. 엣지 케이스 테스트 (Edge Cases)

### EC-1: 빈 폼 제출 시도

**시나리오**: 페이지 로드 직후 "KORMARC 생성" 버튼 클릭

**예상 동작**: 버튼이 비활성화되어 클릭되지 않음

**검증**: 버튼의 disabled 속성 확인

---

### EC-2: 매우 긴 입력값

**시나리오**: 제목 필드에 500글자 이상 입력

**예상 동작**:
- 입력 가능 (필드 제한 없음)
- 폼 제출 시 백엔드에서 처리
- 결과 창에서 올바르게 표시

**입력값**:
```
Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. (더 이상 추가...)
```

---

### EC-3: 특수 문자 입력

**시나리오**: 저자명에 특수 문자 및 유니코드 입력

**입력값**:
- 한글: `김영하`
- 일본어: `村上春樹`
- 특수 문자: `O'Brien`, `José`, `François`
- 이모지: `😀🎉📚`

**예상 동작**:
- 특수 문자 모두 입력 가능
- 결과에 올바르게 인코딩됨
- XSS 공격 방지됨

---

### EC-4: 네트워크 오류 및 타임아웃

**시나리오 1**: API 응답 없음 (타임아웃)

**동작**:
1. "KORMARC 생성" 클릭
2. 로딩 스피너 표시
3. 30초 후 타임아웃
4. "네트워크 연결을 확인해주세요." 메시지 표시
5. "재시도" 버튼 활성화

**검증**: 최대 대기 시간 30초, 명확한 오류 메시지

---

**시나리오 2**: API 오류 (500 Internal Server Error)

**동작**:
1. API 응답: `{ error: "Internal Server Error", code: 500 }`
2. "일시적인 오류가 발생했습니다." 메시지 표시
3. 스택 트레이스 절대 노출 금지

---

### EC-5: 빠른 연속 클릭

**시나리오**: "KORMARC 생성" 버튼을 3번 빠르게 클릭

**예상 동작**:
- 첫 번째 클릭 후 버튼 비활성화
- 2, 3번째 클릭은 무시됨
- API 요청 1회만 전송

**검증**: Network 탭에서 API 요청 1개만 확인

---

### EC-6: 결과 표시 중 폼 수정

**시나리오**: KORMARC 결과 표시 중 ISBN 필드 값 수정

**예상 동작**:
1. ISBN 수정
2. 검증 상태 즉시 업데이트
3. 결과 창은 이전 결과 유지 (사용자가 명시적으로 재생성할 때까지)
4. "KORMARC 생성" 버튼 활성화

---

### EC-7: 브라우저 뒤로가기/앞으로가기

**시나리오**: 폼 작성 → 다른 페이지로 이동 → 뒤로가기

**예상 동작**:
- 이전에 입력한 데이터 복원 (localStorage 활용)
- 결과 창은 초기화 (localStorage에 결과 저장 안 함)

---

### EC-8: localStorage 용량 초과

**시나리오**: 브라우저의 localStorage 용량 초과 시나리오 (드물지만 가능)

**예상 동작**:
1. 저장 실패 시 조용히 실패 (사용자 경험 방해 금지)
2. 콘솔에만 경고 로그 기록
3. 폼 기능은 계속 정상 작동

---

## 3. 성능 기준 (Performance Criteria)

### P-1: 페이지 로딩 성능

**기준**:
- **FCP (First Contentful Paint)**: < 1.5초
- **LCP (Largest Contentful Paint)**: < 2.5초
- **CLS (Cumulative Layout Shift)**: < 0.1
- **Lighthouse 성능 점수**: ≥ 90

**측정 방법**: Lighthouse, PageSpeed Insights, Chrome DevTools Performance 탭

**목표**: 모바일(3G) 네트워크에서도 FCP < 2초

---

### P-2: API 응답 시간

**기준**:
- **평균 응답 시간**: < 100ms
- **P95 응답 시간**: < 200ms
- **P99 응답 시간**: < 500ms

**측정 방법**: 개발자 도구 Network 탭, 백엔드 로그

**목표**: 사용자가 체감할 수 있는 빠른 응답

---

### P-3: 번들 크기

**기준**:
- **JavaScript (gzipped)**: < 100KB
- **CSS (gzipped)**: < 20KB
- **이미지**: < 50KB

**측� 방법**: webpack-bundle-analyzer, Next.js bundle analysis

**최적화 전략**:
- Tree shaking으로 불필요한 코드 제거
- 동적 import로 코드 분할
- 이미지 최적화 (WebP, lazy loading)

---

### P-4: 메모리 사용량

**기준**:
- **초기 메모리**: < 50MB
- **피크 메모리**: < 100MB
- **메모리 누수**: 없음

**측정 방법**: Chrome DevTools Memory 탭, Lighthouse

---

## 4. 접근성 기준 (Accessibility Criteria)

### A-1: WCAG 2.1 AA 준수

**기준**:
- ✓ 모든 색상 대비: 4.5:1 이상 (일반 텍스트)
- ✓ 대형 텍스트: 3:1 이상
- ✓ 초점 순서: 논리적 (Tab 키로 순환)
- ✓ 포커스 인디케이터: 명확함 (∼ 3px 이상)

**측정 도구**: axe DevTools, WAVE, Lighthouse Accessibility

---

### A-2: 키보드 네비게이션

**기준**:
- ✓ Tab 키로 모든 인터랙티브 요소 접근 가능
- ✓ Shift+Tab으로 역순 네비게이션
- ✓ Enter/Space로 버튼 활성화
- ✓ Escape로 모달 닫기 (필요시)

**테스트**: 마우스 없이 Tab 키만 사용하여 전체 기능 완료 가능해야 함

---

### A-3: 스크린 리더 호환성

**기준**:
- ✓ 모든 폼 필드에 명확한 label
- ✓ aria-label 또는 aria-describedby로 추가 설명
- ✓ aria-live="polite"로 동적 상태 변화 전달
- ✓ 버튼 텍스트 명확함 ("제출" 대신 "KORMARC 생성")
- ✓ 오류 메시지가 form control과 연관됨 (aria-describedby)

**테스트 스크린 리더**: NVDA (Windows), JAWS (Windows), VoiceOver (macOS)

---

### A-4: 색상만으로 정보 전달 금지

**기준**:
- ✓ 검증 상태: 색상 + 아이콘 (회색 ○, 노랑 ⋯, 녹색 ✓, 빨강 ✗)
- ✓ 오류: 색상 + 텍스트 메시지
- ✓ 중요 정보: 텍스트로도 전달

---

## 5. 정의된 완료 (Definition of Done)

### 개발 완료 기준

- [x] 모든 EARS 요구사항 구현됨
- [x] 예상 동작과 실제 동작이 일치
- [x] 코드 리뷰 통과
- [x] 모든 테스트 통과 (≥85% 커버리지)
- [x] Linter/Formatter 경고 0개
- [x] TypeScript 타입 에러 0개

### 테스트 완료 기준

- [x] 유닛 테스트: 모든 컴포넌트 및 함수 테스트
- [x] 통합 테스트: API 호출 및 상태 흐름
- [x] E2E 테스트: 3가지 주요 시나리오 (입력 → 생성 → 내보내기)
- [x] 엣지 케이스 테스트: EC-1 ~ EC-8 모두 통과
- [x] 성능 테스트: P-1 ~ P-4 기준 충족
- [x] 접근성 테스트: A-1 ~ A-4 WCAG AA 준수

### 배포 완료 기준

- [x] Lighthouse 점수 90 이상 (4가지 지표 모두)
- [x] 보안 점수 A 이상 (보안 헤더 설정)
- [x] 응답성 테스트 통과 (모바일, 태블릿, 데스크톱)
- [x] 크로스 브라우저 테스트 통과 (Chrome, Firefox, Safari, Edge)
- [x] 성능 모니터링 설정 (Google Analytics 4, Sentry 오류 추적)

---

## 6. 테스트 데이터 및 테스트 계정

### 테스트 용 도서 정보

| ISBN | 제목 | 저자 | 출판사 | 발행년도 | 비고 |
|------|------|------|--------|---------|------|
| 9788954687065 | 영화처럼 아름다운 우리 인생 | 김영하 | 문학동네 | 2015 | 국내 도서 (유효한 ISBN) |
| 0306406237 | The Pragmatic Programmer | David Thomas | Addison-Wesley | 1999 | 해외 도서 (유효한 ISBN-10) |
| 12345 | 테스트용 | 테스트 | 테스트 | 2026 | 무효한 ISBN (테스트) |

### 테스트 사용자 계정

- **테스트 환경**: http://localhost:3000
- **스테이징 환경**: https://kormarc-staging.example.com
- **프로덕션 환경**: https://kormarc.example.com

---

## 7. 결론

이 인수 기준 문서는 SPEC-FRONTEND-001의 모든 요구사항을 검증 가능한 테스트 시나리오로 변환합니다.

**목표**: 개발 완료 시 모든 인수 기준 충족 → 프로덕션 배포 준비 완료
